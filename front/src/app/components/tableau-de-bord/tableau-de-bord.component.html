<div class="min-h-screen flex flex-col bg-[#0B0F18]">
    <eb-hero title="<span>Tableau de bord</span>" subtitle="Vue d'ensemble dynamique de vos bornes & réservations." background="https://images.unsplash.com/photo-1616769366215-8bd0ae79f5d4?auto=format&fit=crop&w=1600&q=80" ctaLabel="Ajouter une borne" ctaRouterLink="/bornes/new" height="sm"></eb-hero>
    <main class="-mt-24 px-6 pb-20 relative z-10">
        <div class="grid gap-6 md:grid-cols-3 mb-10">
            <mat-card ebReveal revealAnimation="fade-up" class="glass-card">
                <mat-card-title>Bornes créées</mat-card-title>
                <mat-card-content>
                    <div class="text-4xl font-poppins font-bold text-cyan-300">{{ bornesByUser.length }}</div>
                    <div class="text-xs text-white/60 mt-1">Associées à votre compte</div>
                </mat-card-content>
            </mat-card>
            <mat-card ebReveal revealAnimation="fade-up" [revealDelay]="120" class="glass-card">
                <mat-card-title>Réservations actives</mat-card-title>
                <mat-card-content>
                    <div class="text-4xl font-poppins font-bold text-cyan-300">{{ activeReservationsCount }}</div>
                    <div class="text-xs text-white/60 mt-1">En cours ou imminentes</div>
                </mat-card-content>
            </mat-card>
            <mat-card ebReveal revealAnimation="fade-up" [revealDelay]="240" class="glass-card">
                <mat-card-title>Dernière mise à jour</mat-card-title>
                <mat-card-content>
                    <div class="text-lg text-white/80">{{ (reservations[0]?.dateDebut || bornesByUser[0]?.dateCreation) | date:'short' || '—' }}</div>
                    <div class="text-xs text-white/50 mt-1">Horodatage récent</div>
                </mat-card-content>
            </mat-card>
        </div>

        <section ebReveal revealAnimation="slide-left" class="mb-12">
            <h2 class="text-xl font-semibold mb-4 font-poppins">Raccourcis</h2>
            <div class="flex flex-wrap gap-3">
                <a mat-stroked-button color="primary" routerLink="/lieux">Lieux</a>
                <a mat-stroked-button color="primary" routerLink="/bornes">Bornes</a>
                <a mat-stroked-button color="primary" routerLink="/reservations">Réservations</a>
            </div>
        </section>

        <div class="grid gap-8 md:grid-cols-2">
            <mat-card ebReveal revealAnimation="fade-in" class="glass-card">
                <mat-card-title class="!mb-2">Bornes associées</mat-card-title>
                <mat-card-content>
                    <div class="max-h-64 overflow-auto thin-scroll pr-2">
                        <div *ngFor="let b of bornesByUser" class="flex justify-between items-center py-2 border-b border-white/5 last:border-none">
                            <div>
                                <div class="text-sm">{{ b.nomBorne || b.nom }}</div>
                                <div class="text-[11px] text-white/50">{{ b.lieu?.instructions || '—' }}</div>
                            </div>
                            <div class="text-xs px-2 py-1 rounded-full" [ngClass]="{'bg-green-500/20 text-green-300': !(b.occupee||false), 'bg-red-500/20 text-red-300': (b.occupee||false)}">{{ b.etat || (b.occupee ? 'Occupée' : 'Libre') }}</div>
                        </div>
                        <div *ngIf="bornesByUser.length === 0" class="text-white/50 text-sm py-4">Aucune borne trouvée.</div>
                    </div>
                </mat-card-content>
            </mat-card>

            <mat-card ebReveal revealAnimation="fade-in" [revealDelay]="120" class="glass-card">
                <mat-card-title class="!mb-2">Réservations récentes</mat-card-title>
                <mat-card-content>
                    <div class="max-h-64 overflow-auto thin-scroll pr-2">
                        <div *ngFor="let r of reservations | slice:0:6" class="py-2 border-b border-white/5 last:border-none flex justify-between gap-3">
                            <div>
                                <div class="text-sm">{{ r.borne?.nomBorne || r.borne?.nom || 'Borne #' + (r.borne?.id || r.idBorne) }}</div>
                                <div class="text-[11px] text-white/50">{{ r.dateDebut | date:'short' }} → {{ r.dateFin | date:'short' }}</div>
                            </div>
                            <div class="text-xs px-2 py-1 rounded-full bg-cyan-500/20 text-cyan-300">{{ r.etat || '—' }}</div>
                        </div>
                        <div *ngIf="(reservations || []).length === 0" class="text-white/50 text-sm py-4">Aucune réservation.</div>
                    </div>
                </mat-card-content>
            </mat-card>
        </div>
    </main>
</div>