{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/api.service\";\nimport * as i2 from \"../../services/auth.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction GestionLieuxComponent_li_10_button_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function GestionLieuxComponent_li_10_button_7_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const l_r1 = i0.ɵɵnextContext().$implicit;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.edit(l_r1));\n    });\n    i0.ɵɵtext(1, \"Edit\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction GestionLieuxComponent_li_10_button_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function GestionLieuxComponent_li_10_button_8_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const l_r1 = i0.ɵɵnextContext().$implicit;\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.remove(l_r1));\n    });\n    i0.ɵɵtext(1, \"Supprimer\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction GestionLieuxComponent_li_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 8)(1, \"div\")(2, \"div\", 9);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 10);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 11);\n    i0.ɵɵtemplate(7, GestionLieuxComponent_li_10_button_7_Template, 2, 0, \"button\", 12);\n    i0.ɵɵtemplate(8, GestionLieuxComponent_li_10_button_8_Template, 2, 0, \"button\", 13);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const l_r1 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(l_r1.nom);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(l_r1.instructions);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", l_r1.utilisateur && (l_r1.utilisateur.id === ctx_r0.currentUserId || l_r1.utilisateur === ctx_r0.currentUserId));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", l_r1.utilisateur && (l_r1.utilisateur.id === ctx_r0.currentUserId || l_r1.utilisateur === ctx_r0.currentUserId));\n  }\n}\nlet GestionLieuxComponent = /*#__PURE__*/(() => {\n  class GestionLieuxComponent {\n    constructor(api, auth) {\n      this.api = api;\n      this.auth = auth;\n      this.lieux = [];\n      this.model = {};\n      this.currentUserId = null;\n    }\n    ngOnInit() {\n      this.load();\n      this.resolveCurrentUser();\n    }\n    load() {\n      this.api.list('lieux').subscribe(d => this.lieux = d || []);\n    }\n    resolveCurrentUser() {\n      const pseudo = this.auth.getPseudoFromToken();\n      if (!pseudo) return;\n      this.api.list('utilisateurs').subscribe(u => {\n        const found = (u || []).find(x => x.pseudo === pseudo || x.adresseMail === pseudo);\n        if (found) this.currentUserId = found.id;\n      });\n    }\n    save() {\n      const payload = {\n        ...this.model\n      };\n      if (!this.model.id && this.currentUserId) payload.utilisateur = {\n        id: this.currentUserId\n      };\n      if (this.model.id) this.api.update('lieux', this.model.id, payload).subscribe(() => this.load());else this.api.create('lieux', payload).subscribe(() => this.load());\n      this.model = {};\n    }\n    edit(l) {\n      this.model = {\n        ...l\n      };\n    }\n    remove(l) {\n      this.api.delete('lieux', l.id).subscribe(() => this.load());\n    }\n    static {\n      this.ɵfac = function GestionLieuxComponent_Factory(t) {\n        return new (t || GestionLieuxComponent)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.AuthService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: GestionLieuxComponent,\n        selectors: [[\"gestion-lieux\"]],\n        decls: 11,\n        vars: 3,\n        consts: [[1, \"max-w-3xl\", \"mx-auto\", \"p-4\", \"bg-surface\", \"rounded\", \"shadow\"], [1, \"text-xl\", \"mb-4\", \"text-foreground\"], [1, \"space-y-2\", \"mb-4\", 3, \"ngSubmit\"], [\"name\", \"nom\", \"placeholder\", \"Nom du lieu\", \"required\", \"\", 1, \"p-2\", \"border\", \"rounded\", \"w-full\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"instructions\", \"placeholder\", \"Instructions\", 1, \"p-2\", \"border\", \"rounded\", \"w-full\", 3, \"ngModel\", \"ngModelChange\"], [1, \"flex\", \"justify-end\"], [\"type\", \"submit\", 1, \"bg-blue-600\", \"text-inverse\", \"px-4\", \"py-2\", \"rounded\"], [\"class\", \"p-2 border-b flex justify-between items-center\", 4, \"ngFor\", \"ngForOf\"], [1, \"p-2\", \"border-b\", \"flex\", \"justify-between\", \"items-center\"], [1, \"font-semibold\"], [1, \"text-sm\", \"text-gray-600\"], [1, \"space-x-2\"], [\"class\", \"px-2 py-1 border rounded\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"px-2 py-1 btn-danger\", 3, \"click\", 4, \"ngIf\"], [1, \"px-2\", \"py-1\", \"border\", \"rounded\", 3, \"click\"], [1, \"px-2\", \"py-1\", \"btn-danger\", 3, \"click\"]],\n        template: function GestionLieuxComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\", 1);\n            i0.ɵɵtext(2, \"Mes lieux\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(3, \"form\", 2);\n            i0.ɵɵlistener(\"ngSubmit\", function GestionLieuxComponent_Template_form_ngSubmit_3_listener() {\n              return ctx.save();\n            });\n            i0.ɵɵelementStart(4, \"input\", 3);\n            i0.ɵɵlistener(\"ngModelChange\", function GestionLieuxComponent_Template_input_ngModelChange_4_listener($event) {\n              return ctx.model.nom = $event;\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(5, \"textarea\", 4);\n            i0.ɵɵlistener(\"ngModelChange\", function GestionLieuxComponent_Template_textarea_ngModelChange_5_listener($event) {\n              return ctx.model.instructions = $event;\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(6, \"div\", 5)(7, \"button\", 6);\n            i0.ɵɵtext(8, \"Enregistrer\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(9, \"ul\");\n            i0.ɵɵtemplate(10, GestionLieuxComponent_li_10_Template, 9, 4, \"li\", 7);\n            i0.ɵɵelementEnd()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"ngModel\", ctx.model.nom);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngModel\", ctx.model.instructions);\n            i0.ɵɵadvance(5);\n            i0.ɵɵproperty(\"ngForOf\", ctx.lieux);\n          }\n        },\n        dependencies: [i3.NgForOf, i3.NgIf, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm],\n        styles: [\"[_nghost-%COMP%]{display:block}\"]\n      });\n    }\n  }\n  return GestionLieuxComponent;\n})();\nexport { GestionLieuxComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}